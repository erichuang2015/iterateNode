/* iterateNode0.0.1 2017-07-31 */

!function(){function a(a,b,c,d){for(var e=d||"?",f=a.split(e),g=b,h=0;h<f.length-1;h++)g=g[f[h]];g[f[f.length-1]]=c}function b(a,b,c,d){for(var e=d||"?",f=a.split(e),g=b,h=0;h<f.length-1;h++)g=g[f[h]];var i=g[f[f.length-1]];delete g[f[f.length-1]],g[c]=i}function c(a,b,c,d,e){for(var f=e||"?",g=a.split(f),h=b,i=0;i<g.length-1;i++)h=h[g[i]];var j=h[g[g.length-1]];j[c]=d}function d(a,b,c){if(!a)return b;for(var d=c||"?",e=a.split(d),f=b,g=0;g<e.length;g++)f=f[e[g]];return f}function e(a,b,c){for(var d=c||"?",e=a.split(d),f=b,g=0;g<e.length-1;g++)f=f[e[g]];if(Array.isArray(f[e])){var h=f[e].indexOf(f[e[e.length-1]]);f[e].splice(h,1)}else delete f[e[e.length-1]]}function f(a,b){var c=document.createElement("a");c.href="javascript:void()",c.className="caretA";var d=document.createElement("span");return d.className="caret",c.addEventListener("click",function(c){c.preventDefault(),c.stopPropagation();var e=a.querySelectorAll("ul")[0];e||(b.countObj=b.countObj+"-",b.asyncFunction?b.asyncFunction(a.getAttribute("data-string-model"),function(c){b.obj=c,a.appendChild(n(b))}):a.appendChild(n(b)));var f=/open/g;f.test(d.className)?(d.className=d.className.replace(f,""),e.className+=" simpleHide"):(d.className+=" open",e&&(e.className=e.className.replace(/simpleHide/g,"")))},!1),c.appendChild(d),c}function g(a,b,e,g,h,i,k,l){a.insertAdjacentHTML("beforeend",g),addItems=a.querySelector(".add-items");var m=a.getAttribute("data-string-model"),n=d(m,e.originalObject);addItems.addEventListener("click",function(d){a.querySelector(".caretA")&&a.removeChild(a.querySelector(".caretA"));var g=Object.keys(n).length,h="[object Object]"==b?"key"+g:g;e.stringModel=m,c(m,e.originalObject,h,"value");var o=j({obj:i,stringModel:k,countObj:l},e,!0),p=f(a,o);a.querySelector("ul")?a.replaceChild(p,a.querySelector("ul")):a.appendChild(p),a.querySelector(".caretA").click()})}function h(c,e,f,g,h,i,j){c.querySelectorAll("[contenteditable]").forEach(function(d,h,l){d.addEventListener("blur",function(h){var l="[object Number]"==i&&d.className.indexOf("iterateNode-sanitize-key-value")<0?isNaN(Number(d.innerText))?0:Number(d.innerText):d.innerText;if(l="[object Boolean]"==i&&d.className.indexOf("iterateNode-sanitize-key-value")<0?"true"==d.innerText.toLowerCase():l,l!=d.innerText&&(d.innerText=l),d.className.indexOf("iterateNode-sanitize-key-value")>=0){var m=c.getAttribute("data-string-model"),n=m.split("?");n[n.length-1]=d.innerText;n.join("?");b(m,e.originalObject,d.innerText);var o=c.parentNode,p=o.parentNode.getAttribute("data-string-model");e.stringModel=p;var q=k(d.innerText,f,e,g);o.replaceChild(q,c)}else a(j,e.originalObject,l);console.log("[originalObject] : \n",e.originalObject)})});var m=c.querySelector(".iterateNode-sanitize-key-typeof-value");m.addEventListener("click",function(b){var f=document.createElement("select"),i=document.createElement("option");f.appendChild(i);for(element in l){var i=document.createElement("option");i.value=element,i.innerHTML=l[element].label,f.appendChild(i)}c.children[0].replaceChild(f,m),f.addEventListener("change",function(b){var i=c.getAttribute("data-string-model"),j=l[f.value].converter();console.log("newValue",j),a(i,e.originalObject,j);var m=d(i,e.originalObject);console.log(m),console.log("options.originalObject",e.originalObject);var n=c.parentNode;e.stringModel=n.parentNode.getAttribute("data-string-model");var o=k(h,j,e,g);console.log("iterateNode",o),n.replaceChild(o,c)})})}function i(a,b){var c=document.createElement("i");c.className="iterateNode-delete-item",c.innerHTML="-",a.appendChild(c),c.addEventListener("click",function(c){var d=a.getAttribute("data-string-model");e(d,b.originalObject),a.parentNode.removeChild(a)})}function j(a,b,c){var d=Array.isArray(b)?[]:{};for(var e in b){var f=Object.prototype.toString.call(b[g]);"[object Object]"!=f&&"[object Array]"!=f||!b[e]?d[e]=a[e]||b[e]:d[e]=a[e]?j(a[e],b[e],c):b[e]}if(c)for(var g in a)d[g]=d[g]||a[g];return d}function k(a,b,c,d){var e=Object.prototype.toString.call(b),k=e;if(c.typeOfFilter){var l=c.typeOfFilter(e,b);k=l.typeofValue,b=l.node,e=Object.prototype.toString.call(b)}var m=c.stringModel.length?c.stringModel+"?"+a:a,n=c.countObj+d,p=c.sanitizedObjects.indexOf(a)>-1?"node-iterator-text-content":"",q=c.contentEditable?" contenteditable ":"",r=!c.contentEditable||"[object Object]"!=e&&"[object Array]"!=e?"":"<span class='add-items'>+</span>",s=document.createElement("li");if(s.id="iterateNode-"+n,s.setAttribute("data-string-model",m),s.setAttribute("data-type-of",e),s.className="iterateNode-"+e.replace(/[\[\]]/g,"").replace(/\s+/,"-"),s.innerHTML="<span class='"+p+"'><i class='iterateNode-sanitize-key'>"+c.key+"</i><b class='iterateNode-sanitize-key-value'"+q+">"+a+"</b><span class='iterateNode-sanitize-separator1'>"+c.Separator1+"</span><span class='iterateNode-sanitize-key-typeof'>"+c.Typeof+"</span><i class='iterateNode-sanitize-key-typeof-value' data-value='"+k+"'>"+k+"</i></span>",c.sanitizedObjects.indexOf(a)>-1){var t=o(b);s.innerHTML+="<pre class='iterateNode-sanitizedHTML'>"+t+"</pre>"}else if("object"==typeof b&&b)if("[object Object]"!=e&&"[object Array]"!=e||Object.keys(b).length||c.asyncFunction){var u=j({obj:b,stringModel:m,countObj:n},c,!0),v=f(s,u);s.appendChild(v)}else;else c.sanitizedObjects.indexOf(a)<0&&(s.innerHTML+=null!=b?"<span class='iterateNode-sanitize-separator2'>"+c.Separator2+"</span><b class='iterateNode-sanitize-value'"+q+">"+b+"</b>":" null");return c.contentEditable&&(h(s,c,b,d,a,e,m),i(s,c)),c.contentEditable&&r&&g(s,e,c,r,d,b,m,n),s}var l={"[object Number]":{label:"number",converter:function(){return Number()}},"[object String]":{label:"string",converter:function(){return String()}},"[object Boolean]":{label:"boolean",converter:function(){return Boolean()}},"[object Array]":{label:"list of values",converter:function(a){return[]}},"[object Object]":{label:"list of elements",converter:function(a){return{}}},"[object Null]":{label:"null",converter:function(a){return null}}},m={countObj:"",stringModel:"",key:"key:",Separator1:" -- ",Typeof:"typeof:",Separator2:" -- ",Include:[],Exclude:[],sanitizedObjects:["outerText","innerText","innerHTML","outerHTML"]},n=function(a){var b=document.createDocumentFragment(),c=document.createElement("ul");c.className="iterateNode-obj",a.name&&(c.id=a.name,a.name=null);var d=0,e=a.filterFunction?a.filterFunction(a.obj):a.obj;a.flatArrays;a.originalObject||(a.originalObject=a.obj);var f=j(a,m,!0);for(var g in e){var h=k(g,e[g],f,d);c.appendChild(h),d++}return b.appendChild(c),b},o=function(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a};window.iterateNode=n}();
//# sourceMappingURL=iterateNode.min.js.map